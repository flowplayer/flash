(function(a){$f.addPlugin("bitrateselect",function(c,n){var m=this;var b={selectedBitrateClass:"bitrate-selected",pluginName:"bitrateselect",templateId:null,fadeTime:500,seperator:" "};a.extend(b,n);var e=c;var l=null;var j=m.getPlugin(b.pluginName)||null;var f=null;function h(o){var p=l;a.each(o,function(q,r){if(q=="bitrate"||q=="label"&&!o.label){p=p.replace("{label}",o.bitrate+" k").replace("%7B"+q+"%7D",o.bitrate+" k")}p=p.replace("{"+q+"}",r).replace("%7B"+q+"%7D",r)});return p}function g(o){if(!j){return false}j.setBitrate(o);return false}function d(o){e.children().removeClass(b.selectedBitrateClass);o.addClass(b.selectedBitrateClass)}function k(){e.fadeOut(b.fadeTime).empty();var q=a("#"+m.id()).width();var o=0;var p=m.getClip();a.each(f,function(){var r=h(this);r=a(r);r.attr("index",this.bitrate);r.show();r.click(function(){d(r);g(a(this).attr("index"));if(a(this).is("a")){return false}});e.append(r);if(o<f.length-1){e.append(b.seperator)}o++});if(e.parent().css("display")=="none"){e.show();e.parent("div").fadeIn(b.fadeTime)}else{e.fadeIn(b.fadeTime)}}function i(){f=m.getClip().bitrateItems?m.getClip().bitrateItems:m.getClip().bitrates;if(f.length>0){e=a(e);l=b.templateId?a("<div>").append(a(b.templateId).clone()).remove().html():e.html();e.empty();k()}}m.onStart(function(o){i();d(a('[index = "'+o.bitrate+'"]',a(e)))});return m})})(jQuery);